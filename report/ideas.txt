todo
====
  pick list of interesting experiments
    focus on death spirals and robustness to randomness
  read other papers


  use public last price for marking wealth

  time metrics
    wall clock
    pairs (all trades)
      seem more natural to Paul
    calls to oracles (sensitive to dynamic sizing)


summary statistics 
==================
  % that converged
  % that diverged
  at [convergence/end]
    wealth
    Dwealth
    D%wealth
    time (time/round)
    Dutility
    mrs spread
    constrainedness
    
    should these be averaged over Z rounds?

  distance from centralised deterministic system
    utility? (might be lower in central!)
    mrs distance

  use Stats when printing daily data

time metrics
============
  wall clock
  rounds
  pairs (all trades)
  non-zero trades
  calls to oracles (sensitive to dynamic sizing)

convergence criteria
====================
  moving averages of [wealths/utilities] are within moving standard deviation of each other
  must be before divergence
    TODO: or disallows divergence?
  
  
divergence criteria
===================
  diff of moving averages of utilities is negative outside tolerance
  mrs is high


motivation
==========
  tatonnement is like centrally planned economy
  restrictions on pricing or utility functions


information we have access to
=============================
  whether traders will accept a trade or not
  their MRS at a given point
    is this realistic?
    needs differentiability
  without differentiability
    can used stochastic utility functions
    

what happens in an individual day
=================================
  loop:
    pick 2 traders
    figure which dir they want to trade (needs diff)
    calculate joint mrs / price to trade at
      this could be done with individual mrs or with constraints
    choose size
      fixed: medium size
      dynamic: largest plus-u size

    change allocations if plus-u

  stopping conditions
    wait until x empty trades
    could use variation in public last mrs
    could have fixed numbers
    wait until X% of recent trades are empty
    could check every trader?
    choice of finish count?
      scaled per trader
      seems like high finish count can avoid the need for backtracking
      very important for dumb trades

across rounds
=============
  tighten constraints if
    lost wealth (privately estimated)

  each metric used
    wealths (publicly calculated from truth)
    utilities
    mrs convergences
    constrainedness
      theoretical maximum

  stopping conditions
    access to global information?

  death spirals
    what characterizes death spiral
      mrsc goes way up
      utility goes down
    why do they occur?
      trading stops as rounds fail to converge 
    how to fight them
      backtracking

parameters
==========
  traders/rounds
    single day
    multiple days
  seeds
    stability across seeds
  sizing (min/dynamic)
    effect on time/convergence
  finish count

  constraints
    metrics
      speed
      death spirals
    
    modes (new constraints)
      fixed
        constraint factor
      last
        suggested by paper
      mean

    reversion
      mean
      total
      random

    backtracks
      needed to capture longer term problems
      many variables being optimized at once, so will step on each others' toes sometimes

      selection of backtrack points
      probability
      threshold

comparison to centralised algorithms
====================================
  tatonnement
  fancier, more efficient ones
  divisible goods

figures
=======
  price/volume for 1 trader over a couple days
    area over curve is wealth lost
    show constraint
  1 day among 2, 3, 4 traders
  across time for 100 traders
  bar charts comparing experiments